<div class="upload-container" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" (drop)="onDrop($event)"
    [class.dragover]="isDragover" [class.loading]="subiendo">

    <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" hidden>

    <!-- Estado: sin imagen -->
    <div class="upload-content" *ngIf="!previewUrl">
        <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z" />
        </svg>
        <p>Arrastra tu imagen aquí o</p>
        <button class="btn-seleccionar" type="button" (click)="fileInput.click()">
            Seleccionar archivo
        </button>
    </div>

    <!-- Estado: con imagen (preview) -->
    <div class="preview" *ngIf="previewUrl">
        <img [src]="previewUrl" alt="Vista previa">

        <!-- Spinner de carga -->
        <div class="upload-overlay" *ngIf="subiendo">
            <div class="spinner"></div>
            <span>Subiendo...</span>
        </div>

        <!-- Botón eliminar (solo cuando no está subiendo) -->
        <button class="btn-remover" type="button" (click)="removeImage()" *ngIf="!subiendo"
            aria-label="Eliminar imagen">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
            </svg>
        </button>

        <!-- Botón cambiar imagen -->
        <button class="btn-cambiar" type="button" (click)="fileInput.click()" *ngIf="!subiendo">
            Cambiar imagen
        </button>
    </div>

    <!-- Mensaje de error -->
    <p class="upload-error" *ngIf="errorMsg">{{ errorMsg }}</p>
</div>